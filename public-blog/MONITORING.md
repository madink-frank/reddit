# Public Blog Monitoring Guide

This document covers the comprehensive monitoring setup for the Reddit Trends Public Blog, including analytics, error tracking, and performance monitoring.

## Overview

The monitoring system includes:
- **Google Analytics 4**: User behavior and traffic analytics
- **Performance Monitoring**: Core Web Vitals and resource tracking
- **Error Tracking**: JavaScript errors and performance issues
- **Real-time Monitoring**: Development dashboard for debugging

## Quick Setup

### 1. Automated Setup
```bash
npm run setup:monitoring
```

This interactive script will:
- Configure Google Analytics
- Set up error tracking
- Create environment files
- Generate Vercel deployment variables

### 2. Manual Setup

#### Environment Variables
Create `.env.production` with:
```bash
# Google Analytics
VITE_GOOGLE_ANALYTICS_ID=G-XXXXXXXXXX
VITE_GOOGLE_TAG_MANAGER_ID=GTM-XXXXXXX

# Error Tracking
VITE_SENTRY_DSN=https://your-sentry-dsn
VITE_ERROR_TRACKING_ENDPOINT=https://your-error-endpoint

# Monitoring Settings
VITE_ENABLE_PERFORMANCE_TRACKING=true
VITE_ENABLE_ERROR_TRACKING=true
VITE_ENABLE_ANALYTICS=true
VITE_DEBUG_MODE=false
```

## Google Analytics Setup

### 1. Create GA4 Property
1. Go to [Google Analytics](https://analytics.google.com)
2. Create a new GA4 property
3. Copy the Measurement ID (G-XXXXXXXXXX)

### 2. Configure Enhanced Ecommerce (Optional)
```javascript
// Track blog post engagement
gtag('event', 'blog_post_view', {
  content_type: 'blog_post',
  content_id: 'post-123',
  content_group1: 'Technology',
});
```

### 3. Set Up Custom Events
The blog automatically tracks:
- Page views
- Blog post reads
- Search queries
- Newsletter subscriptions
- Social shares
- Download events
- Outbound link clicks

### 4. Configure Goals
Set up the following goals in GA4:
- **Newsletter Subscription**: Event = `subscription`
- **Blog Post Engagement**: Event = `blog_post_view`
- **Search Usage**: Event = `search`
- **Social Sharing**: Event = `share`

## Performance Monitoring

### Core Web Vitals Tracking

The system automatically tracks:
- **First Contentful Paint (FCP)**: < 1.8s
- **Largest Contentful Paint (LCP)**: < 2.5s
- **First Input Delay (FID)**: < 100ms
- **Cumulative Layout Shift (CLS)**: < 0.1
- **Time to First Byte (TTFB)**: < 800ms

### Performance Budget

```javascript
const PERFORMANCE_BUDGET = {
  fcp: 1800,      // 1.8s
  lcp: 2500,      // 2.5s
  fid: 100,       // 100ms
  cls: 0.1,       // 0.1
  ttfb: 800,      // 800ms
  totalSize: 2000000,    // 2MB
  imageSize: 1000000,    // 1MB
  scriptSize: 500000,    // 500KB
  styleSize: 100000,     // 100KB
};
```

### Resource Monitoring

Tracks:
- Bundle sizes
- Image optimization
- Font loading
- API response times
- Memory usage

### Performance Testing

```bash
# Run Lighthouse audit
npm run test:performance

# Analyze bundle size
npm run analyze:bundle

# Build with monitoring
npm run monitor:build
```

## Error Tracking

### Automatic Error Capture

The system automatically captures:
- JavaScript runtime errors
- Unhandled promise rejections
- React component errors
- API request failures
- Performance issues

### Manual Error Reporting

```javascript
import { captureError, captureApiError } from '@/utils/errorTracking';

// Capture custom errors
captureError({
  message: 'Custom error occurred',
  stack: error.stack,
  userId: 'user-123'
});

// Capture API errors
captureApiError('/api/posts', 500, 'Internal Server Error', requestData);
```

### Error Boundaries

React Error Boundaries are automatically set up to catch component errors:

```jsx
import { ErrorBoundary } from '@/utils/errorTracking';

<ErrorBoundary fallback={CustomErrorComponent}>
  <YourComponent />
</ErrorBoundary>
```

## Development Monitoring Dashboard

### Accessing the Dashboard

In development mode:
1. Start the development server: `npm run dev`
2. Look for the monitoring panel in the bottom-right corner
3. Or add `?debug=true` to any URL

### Dashboard Features

#### Performance Tab
- Real-time Core Web Vitals
- Performance budget status
- Memory usage monitoring
- Resource analysis (largest/slowest)

#### Errors Tab
- Error summary and statistics
- Recent error details
- Performance issue tracking
- Error categorization

#### Analytics Tab
- Analytics configuration status
- Test event functionality
- Debug information

## Deployment Monitoring

### Vercel Setup

1. **Environment Variables**:
   ```bash
   # Copy from vercel-env-vars.txt (generated by setup script)
   VITE_GOOGLE_ANALYTICS_ID=G-XXXXXXXXXX
   VITE_ENABLE_PERFORMANCE_TRACKING=true
   VITE_ENABLE_ERROR_TRACKING=true
   NODE_ENV=production
   ```

2. **Vercel Analytics** (Optional):
   - Enable in Vercel dashboard
   - Provides additional performance insights
   - Complements Google Analytics

### Build-time Monitoring

```bash
# Production build with monitoring
npm run build:production

# Analyze build output
npm run analyze:bundle

# Deploy with monitoring
npm run deploy:vercel
```

## Monitoring Best Practices

### 1. Performance Optimization

```javascript
// Lazy load components
const LazyComponent = React.lazy(() => import('./Component'));

// Optimize images
<OptimizedImage
  src="/image.jpg"
  alt="Description"
  loading="lazy"
  sizes="(max-width: 768px) 100vw, 50vw"
/>

// Preload critical resources
<link rel="preload" href="/critical.css" as="style" />
```

### 2. Error Prevention

```javascript
// Use error boundaries
<ErrorBoundary>
  <SuspiciousComponent />
</ErrorBoundary>

// Handle async errors
try {
  const data = await fetchData();
} catch (error) {
  captureError({ message: error.message, stack: error.stack });
}
```

### 3. Analytics Optimization

```javascript
// Track meaningful events
trackEvent({
  event_name: 'blog_engagement',
  event_category: 'Content',
  event_label: 'Read Time',
  value: readTimeSeconds
});

// Set user properties
setUserProperties({
  user_type: 'subscriber',
  preferred_theme: 'dark'
});
```

## Troubleshooting

### Common Issues

#### 1. Analytics Not Working
- **Check GA ID**: Verify the Google Analytics ID is correct
- **Environment Variables**: Ensure variables are set in production
- **Ad Blockers**: Test with ad blockers disabled
- **Console Errors**: Check browser console for errors

#### 2. Performance Issues
- **Bundle Size**: Run `npm run analyze:bundle`
- **Images**: Optimize and use modern formats (WebP, AVIF)
- **Code Splitting**: Implement lazy loading
- **Caching**: Verify service worker and HTTP caching

#### 3. Error Tracking
- **Console Errors**: Check browser developer tools
- **Network Requests**: Verify error reporting endpoints
- **Error Boundaries**: Test component error handling
- **Source Maps**: Ensure source maps are available for debugging

### Debug Commands

```bash
# Check bundle size
npm run analyze:bundle

# Run performance audit
npm run test:performance

# Build with analysis
npm run monitor:build

# Setup monitoring from scratch
npm run setup:monitoring
```

### Monitoring Checklist

- [ ] Google Analytics configured and tracking
- [ ] Performance budget thresholds set
- [ ] Error boundaries implemented
- [ ] Core Web Vitals monitoring active
- [ ] Resource optimization in place
- [ ] Error tracking functional
- [ ] Development dashboard accessible
- [ ] Production monitoring verified

## Advanced Configuration

### Custom Analytics Events

```javascript
// Track blog-specific metrics
export const trackBlogMetrics = {
  readingTime: (postId, timeSpent) => {
    trackEvent({
      event_name: 'reading_time',
      event_category: 'Engagement',
      event_label: postId,
      value: timeSpent
    });
  },
  
  scrollDepth: (postId, percentage) => {
    trackEvent({
      event_name: 'scroll_depth',
      event_category: 'Engagement',
      event_label: postId,
      value: percentage
    });
  }
};
```

### Performance Monitoring Customization

```javascript
// Custom performance thresholds
const customBudget = {
  ...DEFAULT_PERFORMANCE_BUDGET,
  lcp: 2000, // Stricter LCP requirement
  totalSize: 1500000, // Smaller bundle size limit
};

const budgetChecker = new PerformanceBudgetChecker(customBudget);
```

### Error Tracking Enhancement

```javascript
// Custom error categorization
const categorizeError = (error) => {
  if (error.message.includes('ChunkLoadError')) return 'Bundle Loading';
  if (error.message.includes('Network')) return 'Network Error';
  if (error.stack?.includes('React')) return 'React Error';
  return 'Unknown Error';
};
```

## Support and Resources

- **Google Analytics Help**: [GA4 Documentation](https://support.google.com/analytics/answer/10089681)
- **Web Vitals**: [Core Web Vitals Guide](https://web.dev/vitals/)
- **Vercel Analytics**: [Vercel Analytics Docs](https://vercel.com/docs/analytics)
- **Performance Optimization**: [React Performance Guide](https://react.dev/learn/render-and-commit)

For additional support, check the project's GitHub issues or contact the development team.